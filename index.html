<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Juego de Carreteras Mejorado</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
  canvas { display: block; background: #f0f0f0; margin: 0 auto; }
</style>
</head>
<body>

<canvas id="mapa" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById('mapa');
const ctx = canvas.getContext('2d');

// ---------- CONFIGURACIONES ----------
const coloresComarcas = ['#FFDAB9','#E0FFFF','#FFE4E1','#F0E68C','#D8BFD8','#98FB98'];
const ciudades = [
  {nombre:'Ciudad A', x:100, y:100},
  {nombre:'Ciudad B', x:300, y:150},
  {nombre:'Ciudad C', x:200, y:300},
  {nombre:'Ciudad D', x:500, y:400},
  {nombre:'Ciudad E', x:650, y:200},
];
const carreteras = [
  [0,1],[1,2],[2,3],[3,4]
];
const comarcas = [
  {puntos:[{x:50,y:50},{x:350,y:50},{x:350,y:200},{x:50,y:200}], vecinos: [1]},
  {puntos:[{x:360,y:50},{x:700,y:50},{x:700,y:250},{x:360,y:200}], vecinos: [0,2]},
  {puntos:[{x:200,y:210},{x:500,y:210},{x:500,y:450},{x:200,y:350}], vecinos:[1]}
];

// ---------- FUNCIONES ----------
function dibujarCarreteras() {
  ctx.strokeStyle = 'gray';
  ctx.lineWidth = 2;
  carreteras.forEach(([a,b])=>{
    ctx.beginPath();
    ctx.moveTo(ciudades[a].x, ciudades[a].y);
    ctx.lineTo(ciudades[b].x, ciudades[b].y);
    ctx.stroke();
  });
}

function colorearComarcas() {
  const asignados = [];
  
  function colorValido(comarcaIndex) {
    const vecinos = comarcas[comarcaIndex].vecinos;
    const usados = vecinos.map(v => asignados[v]).filter(c => c !== undefined);
    return coloresComarcas.filter(c => !usados.includes(c));
  }

  comarcas.forEach((comarca,i)=>{
    const disponibles = colorValido(i);
    asignados[i] = disponibles[Math.floor(Math.random()*disponibles.length)];
    // dibujar pol√≠gono
    ctx.fillStyle = asignados[i];
    ctx.beginPath();
    const pts = comarca.puntos;
    ctx.moveTo(pts[0].x, pts[0].y);
    for(let j=1;j<pts.length;j++) ctx.lineTo(pts[j].x, pts[j].y);
    ctx.closePath();
    ctx.fill();

    // dibujar borde blanco
    ctx.strokeStyle = 'white';
    ctx.lineWidth = 2;
    ctx.stroke();
  });
}

function dibujarCiudades() {
  const posiciones = [];
  ciudades.forEach(c=>{
    // evitar solapamiento simple
    let posX = c.x, posY = c.y;
    let colision = true;
    while(colision) {
      colision = false;
      for(const p of posiciones){
        if(Math.abs(p.x-posX)<50 && Math.abs(p.y-posY)<20){
          posY += 15; // mover hacia abajo
          colision = true;
          break;
        }
      }
    }
    posiciones.push({x:posX,y:posY});
    // dibujar ciudad
    ctx.fillStyle = 'black';
    ctx.font = '14px Arial';
    ctx.fillText(c.nombre, posX, posY);
    // opcional: dibujar punto de la ciudad
    ctx.beginPath();
    ctx.arc(c.x, c.y, 5, 0, 2*Math.PI);
    ctx.fill();
  });
}

// ---------- DIBUJAR MAPA ----------
colorearComarcas();
dibujarCarreteras();
dibujarCiudades();

</script>

</body>
</html>
